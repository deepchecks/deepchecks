
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/tabular/checks/performance/examples/plot_simple_model_comparison.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_tabular_checks_performance_examples_plot_simple_model_comparison.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_tabular_checks_performance_examples_plot_simple_model_comparison.py:


Simple Model Comparison
***********************
This notebooks provides an overview for using and understanding simple model comparison check.

**Structure:**

* `What is the purpose of the check? <#what-is-the-purpose-of-the-check>`__
* `Generate data & model <#generate-data-model>`__
* `Run the check <#run-the-check>`__
* `Define a condition <#define-a-condition>`__

What is the purpose of the check?
=================================
The simple model is designed to produce the best performance achievable using very
simple rules. The goal of the simple model is to provide a baseline of minimal model
performance for the given task, to which the user model may be compared. If the user
model achieves less or a similar score to the simple model, this is an indicator
for a possible problem with the model (e.g. it wasn't trained properly).

The check has three possible "simple model" heuristics, from which one is chosen and
compared to. By default the check uses the **constant** heuristic, which can be
overridden in the checks' parameters using simple_model_type. There is no simple
model which is more "correct" to use, each gives a different baseline to compare to,
and you may experiment with the different types and see how it performs on your data.

The simple models are:

* A **constant** model - The default. In regression the prediction is equal to the
  mean value, in classification the prediction is equal to the most common value.
* A **random88 model - Draws the prediction from the distribution of the labels in the train.
* A **tree** model - Trains a simple decision tree with a given depth. The depth
  can be customized using the ``max_depth`` parameter.

.. GENERATED FROM PYTHON SOURCE LINES 38-40

Generate data & model
=====================

.. GENERATED FROM PYTHON SOURCE LINES 40-46

.. code-block:: default


    from deepchecks.tabular.datasets.classification.phishing import load_data, load_fitted_model

    train_dataset, test_dataset = load_data()
    model = load_fitted_model()








.. GENERATED FROM PYTHON SOURCE LINES 47-56

Run the check
=============
We will run the check with the **tree** model type. The check will use the default
metric defined in deepchecks for classification. This can be overridden by
providing an alternative scorer using the ``alternative_scorers`` parameter.

Note that we are demonstrating on a classification task, but the check also works
for regression tasks. For classification we will see the metrics per class, and for
regression we'll have a single result per metric.

.. GENERATED FROM PYTHON SOURCE LINES 56-63

.. code-block:: default


    from deepchecks.tabular.checks.performance import SimpleModelComparison

    # Using tree model as a simple model, and changing the tree depth from the default 3 to 5
    check = SimpleModelComparison(simple_model_type='tree', max_depth=5)
    check.run(train_dataset, test_dataset, model)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">



    <script type="application/vnd.jupyter.widget-state+json">
    {"version_major":2,"version_minor":0,"state":{"5f758e4c896042b09503f4a7c46c31d7":{"model_name":"VBoxModel","model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","state":{"_dom_classes":[],"children":["IPY_MODEL_16bd7df38d544bb883b4c3666ecbedd2","IPY_MODEL_ae7d6fbf5d00418085546acd4fdf18de","IPY_MODEL_30d4f2fc9ede41e48ebcf9a7cc2517d6"],"layout":"IPY_MODEL_1d3673ecd83446829f21eadc90b86f73"}},"16bd7df38d544bb883b4c3666ecbedd2":{"model_name":"HTMLModel","model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","state":{"_dom_classes":[],"layout":"IPY_MODEL_7fcd356554cf41158ba41f08c18a53e9","style":"IPY_MODEL_5342bb0988d349ffa5a6b71a17eb5d74","value":"<h4>Simple Model Comparison</h4><p>Compare given model score to simple model score (according to given model type). <a href=\"https://docs.deepchecks.com/en/0.6.0.dev1/examples/tabular/checks/performance/simple_model_comparison.html?utm_source=display_output&utm_medium=referral&utm_campaign=check_link\" target=\"_blank\">Read More...</a></p><h5>Additional Outputs</h5>"}},"7fcd356554cf41158ba41f08c18a53e9":{"model_name":"LayoutModel","model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","state":{}},"5342bb0988d349ffa5a6b71a17eb5d74":{"model_name":"DescriptionStyleModel","model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","state":{}},"ae7d6fbf5d00418085546acd4fdf18de":{"model_name":"FigureModel","model_module":"jupyterlab-plotly","model_module_version":"^5.6.0","state":{"_config":{"plotlyServerURL":"https://plot.ly"},"_data":[{"alignmentgroup":"True","bingroup":"x","histfunc":"sum","hovertemplate":"Model=Pipeline model<br>Metric=F1<br>value=%{x}<br>sum of Value=%{y}<extra></extra>","legendgroup":"Pipeline model","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"Pipeline model","offsetgroup":"Pipeline model","orientation":"v","showlegend":true,"x":[0,1],"xaxis":"x","y":{"dtype":"float64","shape":[2]},"yaxis":"y","type":"histogram","uid":"f0bb6e63-754a-498d-a0fc-f17707f71153"},{"alignmentgroup":"True","bingroup":"x","histfunc":"sum","hovertemplate":"Model=Simple model - tree<br>Metric=F1<br>value=%{x}<br>sum of Value=%{y}<extra></extra>","legendgroup":"Simple model - tree","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Simple model - tree","offsetgroup":"Simple model - tree","orientation":"v","showlegend":true,"x":[0,1],"xaxis":"x","y":{"dtype":"float64","shape":[2]},"yaxis":"y","type":"histogram","uid":"39ef6b27-a137-4006-9cfd-775be0aebb02"}],"_dom_classes":[],"_js2py_layoutDelta":{},"_js2py_pointsCallback":{},"_js2py_relayout":{},"_js2py_restyle":{},"_js2py_traceDeltas":{},"_js2py_update":{},"_layout":{"annotations":[{"showarrow":false,"text":"F1","x":0.5,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"barmode":"group","legend":{"title":{"text":"Model"},"tracegroupgap":0},"margin":{"t":60},"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"tickangle":60,"tickprefix":"Class ","type":"category"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"showticklabels":true}},"_py2js_addTraces":{},"_py2js_animate":{},"_py2js_deleteTraces":{},"_py2js_moveTraces":{},"_py2js_relayout":{},"_py2js_removeLayoutProps":{},"_py2js_removeTraceProps":{},"_py2js_restyle":{},"_py2js_update":{},"_view_count":0},"buffers":[{"encoding":"base64","path":["_data",0,"y","buffer"],"data":"sKWu2h3o7z9ezdVczdXsPw=="},{"encoding":"base64","path":["_data",1,"y","buffer"],"data":"+JcdHXZ27j8NmcqQqQzZPw=="}]},"30d4f2fc9ede41e48ebcf9a7cc2517d6":{"model_name":"HTMLModel","model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","state":{"_dom_classes":[],"layout":"IPY_MODEL_53eed7fcbb514bdfa17a9853cf185d5d","style":"IPY_MODEL_a4928bf5e8da418ba562233ff116792f"}},"53eed7fcbb514bdfa17a9853cf185d5d":{"model_name":"LayoutModel","model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","state":{}},"a4928bf5e8da418ba562233ff116792f":{"model_name":"DescriptionStyleModel","model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","state":{}},"1d3673ecd83446829f21eadc90b86f73":{"model_name":"LayoutModel","model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","state":{}}}}
    </script>
    <script type="application/vnd.jupyter.widget-view+json">
    {"version_major":2,"version_minor":0,"model_id":"5f758e4c896042b09503f4a7c46c31d7"}
    </script>


    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 64-80

Observe the check's output
--------------------------
We can see in the results that the check calculates the score for each class in
the dataset, and compares the scores between our model and the simple model.
In addition to the graphic output, the check also returns a value which includes
all of the information that is needed for defining the conditions for validation.

The value is a dictionary of:

- scores - for each metric and class returns the numeric score
- type - the model task type
- scorers_perfect - for each metric the perfect possible score (used to calculate gain)
- classes - the classes exists in the data

Note: for regression ``scores`` will contain for each metric a single numeric score,
and ``classes`` will be null.

.. GENERATED FROM PYTHON SOURCE LINES 80-85

.. code-block:: default


    check = SimpleModelComparison()
    result = check.run(train_dataset, test_dataset, model)
    result.value





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    {'scores': {'F1': defaultdict(<class 'dict'>, {0: {'Origin': 0.9970845481049562, 'Simple': 0.9843400447427293}, 1: {'Origin': 0.9010989010989012, 'Simple': 0.0}})}, 'type': <ModelType.BINARY: 'binary'>, 'scorers_perfect': {'F1': 1.0}, 'classes': (0, 1)}



.. GENERATED FROM PYTHON SOURCE LINES 86-103

Define a condition
==================
We can define on our check a condition that will validate our model is better than
the simple model by a given margin called gain. For classification we check the gain
for each class separately and if there is a class that doesn't pass the defined gain
the condition will fail.

The performance gain is the percent of the improved performance out of the
"remaining" unattained performance. Its purpose is to reflect the significance of
the said improvement. Take for example for a metric between 0 and 1. A change of
only 0.03 that takes us from 0.95 to 0.98 is highly significant (especially in an
imbalance scenario), but improving from 0.1 to 0.13 is not a great achievement.

The gain is calculated as: :math:`gain = \frac{\text{model score} - \text{simple score}}
{\text{perfect score} - \text{simple score}}`

Let's add a condition to the check and see what happens when it fails:

.. GENERATED FROM PYTHON SOURCE LINES 103-109

.. code-block:: default


    check = SimpleModelComparison(simple_model_type='tree')
    check.add_condition_gain_not_less_than(0.9)
    result = check.run(train_dataset, test_dataset, model)
    result.show(show_additional_outputs=False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/shiv/Downloads/deepchecks/deepchecks/core/check_result.py:420: UserWarning:

    You are running in a non-interactive python shell. in order to show result you have to use an IPython shell (etc Jupyter)





.. GENERATED FROM PYTHON SOURCE LINES 110-113

%%
We detected that for class "1" our gain did not passed the target gain we
defined, therefore it failed.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  13.878 seconds)


.. _sphx_glr_download_examples_tabular_checks_performance_examples_plot_simple_model_comparison.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_simple_model_comparison.py <plot_simple_model_comparison.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_simple_model_comparison.ipynb <plot_simple_model_comparison.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
